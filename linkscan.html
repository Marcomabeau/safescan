<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Link Scanner | Digital Security Scanner</title>
  <style>
    /* Dark digital theme */
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background: #0d0d0d; /* Very dark background */
      color: #f5f5f5;      /* Light text color */
    }

    header, footer {
      background: #1a1a1a; /* Slightly lighter than body for contrast */
      padding: 20px;
      text-align: center;
    }

    h1 {
      margin: 0;
      color: #70F8BA; /* Neon-like color to emphasize the “digital” theme */
      font-weight: 400;
      text-shadow: 0 0 5px #70F8BA;
    }

    .container {
      max-width: 600px;
      margin: 50px auto;
      padding: 20px;
      background: #1a1a1a; /* matching the header/footer background */
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(112, 248, 186, 0.2);
    }

    label {
      display: block;
      margin-bottom: 10px;
      font-size: 1.1em;
    }

    input[type="text"] {
      width: 100%;
      padding: 10px;
      margin-bottom: 20px;
      border-radius: 4px;
      border: 1px solid #333;
      background-color: #333;
      color: #fff;
    }

    .buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }

    button {
      padding: 12px 24px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1em;
      color: #fff;
      text-transform: uppercase;
      background: #70F8BA;
      box-shadow: 0 0 10px rgba(112, 248, 186, 0.3);
      transition: background 0.3s ease;
    }

    button:hover {
      background: #5cd5a0; /* Slightly darker hover color */
    }

    #resultContainer {
      margin-top: 30px;
      padding: 20px;
      border: 1px dashed #70F8BA;
      display: none;
    }

    footer {
      margin-top: 50px;
      color: #888;
      font-size: 0.9em;
    }
  </style>
</head>
<body>

<header>
  <h1>Digital Security Scanner</h1>
</header>

<div class="container">
  <label for="urlInput">Enter the link/URL you want to scan:</label>
  <input type="text" id="urlInput" placeholder="https://example.com" />

  <div class="buttons">
    <button id="homeBtn">Home</button>
    <button id="scanBtn">Scan Now</button>
  </div>

  <div id="resultContainer"></div>
</div>

<footer>
  <!-- Reusable Footer: Same style/theme as requested -->
  <p>&copy; 2024 Digital Security Scanner. All rights reserved.</p>
</footer>

<script>
  // Button References
  const homeBtn = document.getElementById('homeBtn');
  const scanBtn = document.getElementById('scanBtn');
  const urlInput = document.getElementById('urlInput');
  const resultContainer = document.getElementById('resultContainer');

  // Home button event to go back to index.html
  homeBtn.addEventListener('click', () => {
    window.location.href = 'index.html';
  });

  // Scan button event to check the URL using an external API
  scanBtn.addEventListener('click', async () => {
    const urlToScan = urlInput.value.trim();
    if (!urlToScan) {
      alert('Please enter a valid URL before scanning.');
      return;
    }

    // Clear previous results
    resultContainer.style.display = 'none';
    resultContainer.innerHTML = '';

    try {
      // Example: Using VirusTotal's v3 API to scan URLs.
      // You need to replace YOUR_API_KEY_HERE with an actual API key
      // from your VirusTotal account or any other open-source service.
      
      const apiKey = '58ee1e0164de388721af7ad203630736166b2af5fbd07c10b74e8a0e120ca3fc';
      const vtUrl = 'https://www.virustotal.com/api/v3/urls';

      // We first need to get the url_id by encoding the URL
      // according to VirusTotal specs (Base64 without '=' and URL safe).
      const urlId = btoa(urlToScan).replace(/=+$/, '');
      
      // Option 1: You can create a new scan for the URL (submit it).
      // const submitResponse = await fetch(vtUrl, {
      //   method: 'POST',
      //   headers: {
      //     'Content-Type': 'application/json',
      //     'x-apikey': apiKey
      //   },
      //   body: JSON.stringify({ url: urlToScan })
      // });
      // const submitData = await submitResponse.json();
      // console.log('Submission response:', submitData);

      // Option 2: Retrieve analysis for the URL
      // (depending on how you want to handle fresh scans vs. existing data).
      const analysisUrl = `${vtUrl}/${urlId}`;
      const response = await fetch(analysisUrl, {
        headers: { 'x-apikey': apiKey }
      });

      if (!response.ok) {
        throw new Error('Failed to fetch the scan result from VirusTotal API.');
      }

      const data = await response.json();
      console.log('VirusTotal Data: ', data);

      // Parse the results for detection. 
      // This is a simple approach for demonstration.
      const analysisStats = data.data?.attributes?.last_analysis_stats;
      const maliciousCount = analysisStats?.malicious || 0;
      const suspiciousCount = analysisStats?.suspicious || 0;

      let message = `<h3>Scan Results:</h3>`;
      if (maliciousCount > 0) {
        message += `<p><strong style="color: #FF5252;">Malicious content detected!</strong></p>`;
      } else if (suspiciousCount > 0) {
        message += `<p><strong style="color: #FFA500;">URL might be suspicious!</strong></p>`;
      } else {
        message += `<p><strong style="color: #70F8BA;">URL seems clean!</strong></p>`;
      }

      message += `<p>Details: ${maliciousCount} malicious, ${suspiciousCount} suspicious detections.</p>`;
      resultContainer.innerHTML = message;
      resultContainer.style.display = 'block';

    } catch (error) {
      console.error(error);
      resultContainer.innerHTML = `<p style="color: #FF5252;">An error occurred while scanning the URL. Please try again later.</p>`;
      resultContainer.style.display = 'block';
    }
  });
</script>
</body>
</html>
